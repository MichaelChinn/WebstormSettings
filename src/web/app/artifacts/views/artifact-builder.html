<div class="ibox float-e-margins">
    <div class="ibox-content">
        <div class="row">
           <div class="col-lg-12">
               <ng-form name="vm.builderForm" novalidate>
                   <div class="row">
                       <div class="col-lg-12">
                           <artifact-rejection ng-if="vm.artifact.wfState === enums.WfState.ARTIFACT_REJECTED" artifact="vm.artifact"></artifact-rejection>
                       </div>
                   </div>
                   <div class="row">
                       <div class="col-lg-12">
                           <div>
                               <div class="row">
                                   <div class="col-lg-12">
                                       <div class="form-group" ng-class="{ 'has-error' : vm.builderForm.artifactTitle.$invalid && !vm.builderForm.artifactTitle.$pristine }">
                                           <label>Title</label>
                                           <input type="text" name="artifactTitle" class="form-control" ng-model="vm.artifact.title" placeholder="Enter Title" required>
                                           <div ng-messages="vm.builderForm.artifactTitle.$error">
                                               <div ng-messages-include="app/core/views/validation-messages.html"></div>
                                           </div>
                                       </div>
                                   </div>
                               </div>
                               <br/>
                               <div class="row">
                                   <div class="col-lg-12">
                                       <label>Attach your artifact item(s)</label>
                                       <artifact-builder-lib-items
                                               ng-show="vm.itemToEdit===null"
                                               artifact="vm.artifact"
                                               edit-item-fcn="vm.editItem"
                                               create-item-fcn="vm.createItem">
                                       </artifact-builder-lib-items>

                                       <artifact-builder-edit-lib-item
                                               ng-show="vm.itemToEdit"
                                               artifact="vm.artifact"
                                               item="vm.itemToEdit"
                                               done-fcn="vm.doneItemEdit"
                                               cancel-fcn="vm.cancelItemEdit" >
                                       </artifact-builder-edit-lib-item>
                                   </div>
                               </div>

                               <br/>
                           </div>
                       </div>
                   </div>
                   <div class="row" ng-if="vm.observations.length>0 || vm.goals.length>0">
                       <div class="col-lg-12">
                           <strong>Link to Observations, Goals, or Self-Assessments</strong>
                           <p>Check the items you want to link this artifact to.</p>
                           <br/>
                           <div ng-if="vm.observations.length>0">
                               <label>Observations</label>
                               <table class="table table-bordered table-condensed" >
                                   <tr ng-repeat="observation in vm.observations">
                                       <td>
                                           <div class="margin-top-5 margin-bottom-5 checkbox checkbox-primary">
                                               <input type="checkbox" id="cbobs{{$index}}{{observation.id}}" ng-checked ="observation.linked" ng-click="observation.linked=!observation.linked"  />
                                               <label for="cbobs{{$index}}{{observation.id}}">
                                                   {{observation.title}}
                                               </label>
                                           </div>
                                       </td>
                                   </tr>
                               </table>
                           </div>
                           <br/>
                           <div ng-if="vm.goalBundles.length>0">
                               <label>Student Growth Goals</label>
                               <table class="table table-bordered table-condensed" >
                                   <tr ng-repeat="bundle in vm.goalBundles">
                                       <td>
                                           <div class="margin-top-5 margin-bottom-5 checkbox checkbox-primary">
                                               <input type="checkbox" id="cbsggoal{{$index}}{{bundle.id}}" ng-checked ="bundle.linked" ng-click="bundle.linked=!bundle.linked"  />
                                               <label for="cbsggoal{{$index}}{{bundle.id}}">
                                                   {{bundle.title}}
                                               </label>
                                           </div>
                                       </td>
                                   </tr>
                               </table>
                           </div>
                       </div>
                   </div>
                    <div class="row">
                        <div class="col-lg-12">
                            <rubric-row-selector rubric-rows="vm.artifact.alignedRubricRows"></rubric-row-selector>
                            <br/><br/>
                            <div class="row">
                                <div class="col-lg-12">
                                    <div>
                                        <div class="alert alert-warning" ng-show="vm.artifact.alignedRubricRows.length>4">
                                               <span class="fa fa-info-circle fa-2x">TODO: need a message about being careful not to over-align.
                                               </span>
                                        </div>
                                        <div class="form-group">
                                            <label>Provide reasoning for your alignment choice(s): (optional)</label>
                                            <textarea rows="3" ng-model="vm.artifact.evidence" class="form-control"></textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                   <div class="row">
                       <div class="col-lg-12">
                           <div>
                               <div class="pull-right">
                                   <button type="button" class="btn btn-default btn-outline btn-sm " ng-click="vm.cancel()">
                                       Cancel
                                   </button>
                                   <button type="submit" class="btn btn-default btn-outline btn-sm" ng-click="vm.saveForLater(vm.artifact)" >
                                       Save for Later
                                   </button>

                                   <button type="submit" class="btn btn-primary btn-sm" ng-click="vm.submit(vm.artifact)">
                                       Submit as Evidence
                                   </button>
                               </div>
                           </div>
                       </div>
                   </div>
               </ng-form>
            </div>
        </div>
    </div>
</div>


